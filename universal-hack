--[[
    hack-multiversal.lua
    Autor: [Tu Nombre o Alias]
    Descripción: Menú de hacks universal multijuego para Roblox.
    Características:
      - Drag & scroll en el panel.
      - Botón minimizar/restaurar visual tipo flechas.
      - PIN pedido solo una vez y guardado (getgenv()).
      - Todos los hacks funcionales con inputs donde corresponde.
      - Sólo un panel visible a la vez, sin bugs de superposición.
      - Compatible con otros scripts y GUIs.
      - Mensaje de bienvenida: "Bienvenido a hack-multiversal"
    IMPORTANTE: Puedes modificar o agregar hacks fácilmente en la sección correspondiente.
--]]

-- CONFIGURACIÓN
local PIN_CORRECTO = "1234" -- Cambia esto por el PIN que quieras

-- UTILIDAD: Guardado de PIN en runtime (solo pide una vez por sesión)
getgenv().hmv_pin_ok = getgenv().hmv_pin_ok or false

if not getgenv().hmv_pin_ok then
    local pin = ""
    repeat
        pin = tostring(game:GetService("StarterGui"):PromptInput("Introduce el PIN para hack-multiversal:"))
    until pin == PIN_CORRECTO
    getgenv().hmv_pin_ok = true
end

-- FUNCIONES DE UTILERÍA
local function makeArrowButton(parent, arrowsIn)
    -- arrowsIn: true (minimizar) | false (restaurar)
    local btn = Instance.new("ImageButton")
    btn.Size = UDim2.new(0, 40, 0, 40)
    btn.BackgroundColor3 = Color3.fromRGB(34,34,34)
    btn.BorderSizePixel = 0
    btn.Name = "ArrowMenuBtn"
    btn.Position = UDim2.new(1, -45, 0, 5)
    btn.AnchorPoint = Vector2.new(1,0)
    btn.ZIndex = 12

    if arrowsIn then
        btn.Image = "rbxassetid://14554499584" -- ICONO: Flechas hacia adentro (minimizar)
    else
        btn.Image = "rbxassetid://14554500672" -- ICONO: Flechas hacia afuera (restaurar)
    end
    btn.ImageColor3 = Color3.new(1,1,1)
    btn.Parent = parent
    return btn
end

local function makeFloatingFrame()
    local gui = Instance.new("ScreenGui")
    gui.Name = "HackMultiversalGUI"
    gui.ResetOnSpawn = false
    gui.IgnoreGuiInset = true
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    -- Frame principal
    local frame = Instance.new("Frame")
    frame.Name = "MainFrame"
    frame.Size = UDim2.new(0, 340, 0, 440)
    frame.Position = UDim2.new(0.1,0, 0.2,0)
    frame.BackgroundColor3 = Color3.fromRGB(40,40,40)
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true -- Roblox classic drag (más seguro para compatibilidad)
    frame.ZIndex = 10
    frame.Parent = gui

    -- Título
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -50, 0, 40)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "Bienvenido a hack-multiversal"
    title.Font = Enum.Font.GothamBold
    title.TextSize = 19
    title.TextColor3 = Color3.fromRGB(255,255,255)
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.ZIndex = 11
    title.Parent = frame

    -- Scroll panel
    local scroll = Instance.new("ScrollingFrame")
    scroll.Name = "HackScroll"
    scroll.Size = UDim2.new(1, -20, 1, -60)
    scroll.Position = UDim2.new(0, 10, 0, 50)
    scroll.BackgroundTransparency = 0.1
    scroll.BackgroundColor3 = Color3.fromRGB(32,32,32)
    scroll.BorderSizePixel = 0
    scroll.CanvasSize = UDim2.new(0,0,0,800) -- ajusta según cantidad de hacks
    scroll.ScrollBarThickness = 6
    scroll.ZIndex = 10
    scroll.Parent = frame

    -- Para minimizar/restaurar
    local minimizeBtn = makeArrowButton(frame, true)
    minimizeBtn.Visible = true
    local restoreBtn = makeArrowButton(gui, false)
    restoreBtn.Position = UDim2.new(0, 15, 0, 15)
    restoreBtn.Size = UDim2.new(0, 44, 0, 44)
    restoreBtn.Visible = false

    -- Drag para restaurarBtn
    local dragging, dragInput, dragStart, startPos
    restoreBtn.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = restoreBtn.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    restoreBtn.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            restoreBtn.Position = UDim2.new(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
        end
    end)

    return gui, frame, scroll, minimizeBtn, restoreBtn
end

-- FUNCIONES DE HACKS
local function popupNumber(title, min, max, default)
    -- Devuelve el número elegido o nil si cancela
    local resp = game:GetService("StarterGui"):PromptInput(title.." ("..min.." - "..max..")", default and tostring(default) or "")
    local num = tonumber(resp)
    if num and num >= min and num <= max then
        return num
    else
        return nil
    end
end

-- Zona para agregar hacks
local hacks = {
    {
        name = "Kill Aura",
        desc = "Ataca automáticamente enemigos cercanos. (1-500 de alcance)",
        input = {type="number", min=1, max=500, default=30},
        func = function(val)
            -- Ejemplo: Atacar enemigos en radio val
            print("Activando KillAura con radio "..val)
            -- Aquí pones tu lógica de búsqueda y daño
        end,
    },
    {
        name = "Velocidad",
        desc = "Cambia la velocidad de caminar (1-100)",
        input = {type="number", min=1, max=100, default=16},
        func = function(val)
            local char = game.Players.LocalPlayer.Character
            if char and char:FindFirstChildOfClass("Humanoid") then
                char:FindFirstChildOfClass("Humanoid").WalkSpeed = val
            end
        end,
    },
    {
        name = "Volar (toggle)",
        desc = "Activa/desactiva modo vuelo.",
        input = nil,
        func = function()
            -- Ejemplo de vuelo simple (toggle)
            local player = game.Players.LocalPlayer
            local char = player.Character
            if not getgenv().hmv_fly then
                getgenv().hmv_fly = true
                local hum = char and char:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum.PlatformStand = true
                    print("Vuelo activado")
                end
            else
                getgenv().hmv_fly = false
                local hum = char and char:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum.PlatformStand = false
                    print("Vuelo desactivado")
                end
            end
        end,
    },
    {
        name = "Noclip (toggle)",
        desc = "Activa/desactiva atravesar paredes.",
        input = nil,
        func = function()
            getgenv().hmv_noclip = not getgenv().hmv_noclip
            if getgenv().hmv_noclip then
                getgenv().hmv_nccon = game:GetService("RunService").Stepped:Connect(function()
                    local char = game.Players.LocalPlayer.Character
                    if char then
                        for _,v in pairs(char:GetDescendants()) do
                            if v:IsA("BasePart") and v.CanCollide then
                                v.CanCollide = false
                            end
                        end
                    end
                end)
            else
                if getgenv().hmv_nccon then getgenv().hmv_nccon:Disconnect() end
            end
        end,
    },
    {
        name = "Teleport Hogar",
        desc = "Teletransporta a tu punto de spawn (o al lobby).",
        input = nil,
        func = function()
            local player = game.Players.LocalPlayer
            local char = player.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                char.HumanoidRootPart.CFrame = CFrame.new(0,10,0) -- Cambia según juego
            end
        end,
    },
    {
        name = "Auto Curar",
        desc = "Te cura automáticamente si tienes menos de la mitad de vida.",
        input = nil,
        func = function()
            getgenv().hmv_autocurar = not getgenv().hmv_autocurar
            if getgenv().hmv_autocurar then
                getgenv().hmv_autocurar_con = game:GetService("RunService").RenderStepped:Connect(function()
                    local char = game.Players.LocalPlayer.Character
                    local hum = char and char:FindFirstChildOfClass("Humanoid")
                    if hum and hum.Health < hum.MaxHealth/2 then
                        hum.Health = hum.MaxHealth
                    end
                end)
            else
                if getgenv().hmv_autocurar_con then getgenv().hmv_autocurar_con:Disconnect() end
            end
        end,
    },
    -- Agrega más hacks aquí...
}

-- CONSTRUCCIÓN DEL GUI
local gui, frame, scroll, minimizeBtn, restoreBtn = makeFloatingFrame()
gui.Parent = game:GetService("CoreGui")

-- Generar botones de hacks
local y = 0
for i, hack in ipairs(hacks) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -10, 0, 45)
    btn.Position = UDim2.new(0, 5, 0, y)
    btn.BackgroundColor3 = Color3.fromRGB(60,60,60)
    btn.BorderSizePixel = 0
    btn.Text = hack.name
    btn.Font = Enum.Font.GothamBold
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextSize = 16
    btn.AutoButtonColor = true
    btn.ZIndex = 10
    btn.Parent = scroll

    -- Tooltip con descripción
    btn.MouseEnter:Connect(function()
        btn.Text = hack.name .. "\n" .. hack.desc
    end)
    btn.MouseLeave:Connect(function()
        btn.Text = hack.name
    end)

    btn.MouseButton1Click:Connect(function()
        -- Si requiere input
        if hack.input and hack.input.type == "number" then
            local val = popupNumber(hack.name, hack.input.min, hack.input.max, hack.input.default)
            if val then
                hack.func(val)
            end
        else
            hack.func()
        end
    end)
    y = y + 50
end
scroll.CanvasSize = UDim2.new(0,0,0, y+10)

-- MINIMIZAR/RESTAURAR
minimizeBtn.MouseButton1Click:Connect(function()
    frame.Visible = false
    restoreBtn.Visible = true
end)
restoreBtn.MouseButton1Click:Connect(function()
    frame.Visible = true
    restoreBtn.Visible = false
end)

-- SOLO UN PANEL VISIBLE SI AÑADES SUBMENÚS (puedes expandir aquí)

-- ¡LISTO!
print("hack-multiversal cargado correctamente.")

-- Puedes modificar el PIN, añadir más hacks, o cambiar el diseño del menú fácilmente.
